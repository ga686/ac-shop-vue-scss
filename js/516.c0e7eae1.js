"use strict";(self["webpackChunksimple_twitter"]=self["webpackChunksimple_twitter"]||[]).push([[516],{4334:function(e,t,s){s.d(t,{Z:function(){return c}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-header d-flex align-item-center"},[t("div",{staticClass:"link-icon",on:{click:function(t){return e.$router.back()}}}),t("div",{staticClass:"user-title d-flex justify-content-center"},[t("h5",{staticClass:"user-name"},[e._v(e._s(e.user.name))]),t("div",{staticClass:"user-tweetCounts number-wrap"},[e._v(e._s(e._f("quantifier")(e.user.tweetsLength)))])])])},r=[],i={props:{user:{name:"",tweetsLength:""}},filters:{quantifier(e){return e+" 推文"}}},l=i,n=s(1001),a=(0,n.Z)(l,o,r,!1,null,"92be4e54",null),c=a.exports},4516:function(e,t,s){s.r(t),s.d(t,{default:function(){return V}});s(7658);var o=function(){var e=this,t=e._self._c;return t("main",{staticClass:"main-view mx-auto"},[t("NavbarLeft"),t("div",{staticClass:"user-page"},[t("UserHeader",{attrs:{user:e.user}}),t("div",{staticClass:"follow-title"},[t("div",{class:["user-followers",{active:"followers"===e.currentView}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.$router.push({path:`/user/follow/followers/${e.user.id}`})}}},[e._v("追蹤者")]),t("div",{class:["user-followings",{active:"followings"===e.currentView}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.$router.push({path:`/user/follow/followings/${e.user.id}`})}}},[e._v("正在追隨")])]),t("UserFollowers",{directives:[{name:"show",rawName:"v-show",value:"followers"===e.currentView,expression:"currentView === 'followers'"}],attrs:{initFollowers:e.user.followers,initUserId:e.user.id}}),t("UserFollowings",{directives:[{name:"show",rawName:"v-show",value:"followings"===e.currentView,expression:"currentView === 'followings'"}],attrs:{initFollowings:e.user.followings}})],1),t("SuggestUser")],1)},r=[],i=s(5272),l=s(2433),n=s(3822),a=s(3507),c=function(){var e=this,t=e._self._c;return t("div",e._l(e.followers,(function(s){return t("div",{key:s.id,staticClass:"comment_wrap d-flex"},[t("div",{staticClass:"avatar_image"},[t("img",{attrs:{src:e._f("emptyImage")(s.avatar)}})]),t("div",{staticClass:"comment_wrap_body"},[t("div",{staticClass:"d-flex comment_wrap_body--title"},[t("h5",{staticClass:"size-16"},[e._v(e._s(s.name))]),t("button",{class:["btn",{unfollow:!s.isFollowed}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.toggleFollow(s)}}},[e._v(e._s(s.isFollowed?"正在跟隨":"跟隨"))])]),t("div",{staticClass:"comment_wrap_body--content mb-3"},[e._v(e._s(s.introduction))])])])})),0)},u=[],w=s(8390),d=s(1905),f=s(6163),h={props:{initFollowers:{type:Array,required:!0},initUserId:{type:Number,required:!0}},mixins:[a.Lf],data(){return{followers:[]}},computed:{...(0,n.rn)(["currentUser","isAuthenticated"])},created(){this.fetchData(this.initUserId)},watch:{initFollowers(){this.fetchData(this.initUserId)}},methods:{async fetchData(e){const{data:t}=await w.Z.getFollowers(e);this.followers=t},async toggleFollow(e){try{const t=e.followerId;if(!1===e.isFollowed){const{data:s}=await d.Z.addFollow(t);if("success"===s)throw new Error(s.message);f.F.fire({icon:"success",title:"成功追蹤"}),e.isFollowed=!e.isFollowed}else{const{data:e}=await d.Z.deleteFollow(t);if("success"===e)throw new Error(e.message);f.F.fire({icon:"success",title:"成功取消追蹤"})}}catch(t){console.log(t),f.F.fire({icon:"error",title:"追蹤失敗，請稍後再試"})}}}},m=h,g=s(1001),p=(0,g.Z)(m,c,u,!1,null,"fc16b37a",null),v=p.exports,_=function(){var e=this,t=e._self._c;return t("div",e._l(e.followings,(function(s){return t("div",{key:s.id,staticClass:"comment_wrap d-flex"},[t("div",{staticClass:"avatar_image"},[t("img",{attrs:{src:e._f("emptyImage")(s.avatar)}})]),t("div",{staticClass:"comment_wrap_body"},[t("div",{staticClass:"d-flex comment_wrap_body--title"},[t("h5",{staticClass:"size-16"},[e._v(e._s(s.name))]),t("button",{class:["btn",{unfollow:!e.isFollowed}],on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.deleteFollowing(s.id)}}},[e._v(e._s(e.isFollowed?"正在跟隨":"跟隨"))])]),t("div",{staticClass:"comment_wrap_body--content mb-3"},[e._v(e._s(s.introduction))])])])})),0)},F=[],C={props:{initFollowings:{type:Array,required:!0}},mixins:[a.Lf],data(){return{followings:[],isFollowed:!0}},created(){this.fetchData()},computed:{...(0,n.rn)(["currentUser","isAuthenticated"])},watch:{initFollowings(){this.fetchData()}},methods:{fetchData(){this.followings=this.initFollowings},async deleteFollowing(e){try{const{data:t}=await d.Z.deleteFollow({userId:e});if("success"!==t.status)throw new Error(t.message);f.F.fire({icon:"success",title:"成功取消追蹤"}),this.followings=this.followings.filter((t=>t.id!==e))}catch(t){console.log(t),f.F.fire({icon:"error",title:"取消追蹤失敗，請稍後再試"})}}}},y=C,b=(0,g.Z)(y,_,F,!1,null,"0692a071",null),x=b.exports,U=s(4334),k={name:"userPage",components:{NavbarLeft:i.Z,SuggestUser:l.Z,UserFollowers:v,UserFollowings:x,UserHeader:U.Z},mixins:[a.Lf,a.$2],data(){return{user:{id:-1,name:"",tweetsLength:0,followers:[],followings:[]},isShow:!1,currentView:""}},created(){const{id:e}=this.$route.params,t=this.$route.params.user;this.currentView=e,this.fetchFollow(t)},computed:{...(0,n.rn)(["currentUser"])},beforeRouteUpdate(e,t,s){const{id:o}=e.params,r=e.params.user;this.currentView=o,this.fetchFollow(r),s()},methods:{async fetchFollow(e){try{const{data:t}=await w.Z.get(e),{id:s,name:o,Tweets:r,Followers:i,Followings:l}=t;this.user={...this.user,id:s,name:o,tweetsLength:r.length,followers:i,followings:l}}catch(t){console.log(t)}},openModal(){return this.isShow=!0},closeModal(e){return this.isShow=e},toggleContent(e){this.currentView=e}},filters:{quantifier(e){return e+" 推文"}}},Z=k,D=(0,g.Z)(Z,o,r,!1,null,"5d433856",null),V=D.exports}}]);
//# sourceMappingURL=516.c0e7eae1.js.map